<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;My Electron App&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>body {</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-family: Arial, sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin: 40px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #f7f7f7;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #222;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>h1 {</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #3a3a3a;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.container {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #fff;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 32px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>max-width: 500px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin: 0 auto;</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: 0 2px 12px rgba(0,0,0,0.08);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.file-input {</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#progress-container {</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin: 20px 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#progress-bar {</p>
<p class="p1"><span class="Apple-converted-space">      </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">      </span>height: 18px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #e0e0e0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-radius: 9px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#progress-bar-inner {</p>
<p class="p1"><span class="Apple-converted-space">      </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">      </span>width: 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #4caf50;</p>
<p class="p1"><span class="Apple-converted-space">      </span>transition: width 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#result, #error {</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 12px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#result {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #e8f5e9;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #256029;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>#error {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #ffebee;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #b71c1c;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>button {</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 10px 24px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #1976d2;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #fff;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 16px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin-top: 10px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>button:disabled {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #90caf9;</p>
<p class="p1"><span class="Apple-converted-space">      </span>cursor: not-allowed;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;h1&gt;Process a File&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="file-input"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;input type="file" id="fileInput" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;button id="processBtn" disabled&gt;Process&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="progress-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div id="progress-bar"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="progress-bar-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="result"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="error"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const { ipcRenderer } = window.require ? window.require('electron') : window.electron;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const fileInput = document.getElementById('fileInput');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const processBtn = document.getElementById('processBtn');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const progressContainer = document.getElementById('progress-container');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const progressBarInner = document.getElementById('progress-bar-inner');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const resultDiv = document.getElementById('result');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const errorDiv = document.getElementById('error');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>let selectedFilePath = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>fileInput.addEventListener('change', (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (e.target.files.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>selectedFilePath = e.target.files[0].path;</p>
<p class="p1"><span class="Apple-converted-space">        </span>processBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>resultDiv.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>errorDiv.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">      </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">        </span>processBtn.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>processBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!selectedFilePath) return;</p>
<p class="p1"><span class="Apple-converted-space">      </span>processBtn.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">      </span>progressContainer.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">      </span>progressBarInner.style.width = '0%';</p>
<p class="p1"><span class="Apple-converted-space">      </span>resultDiv.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">      </span>errorDiv.style.display = 'none';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>ipcRenderer.send('process-file', selectedFilePath);</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>ipcRenderer.on('process-progress', (event, percent) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>progressBarInner.style.width = percent + '%';</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>ipcRenderer.on('process-result', (event, data) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>progressContainer.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">      </span>resultDiv.textContent = data;</p>
<p class="p1"><span class="Apple-converted-space">      </span>resultDiv.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">      </span>processBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>ipcRenderer.on('process-error', (event, error) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>progressContainer.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">      </span>errorDiv.textContent = error;</p>
<p class="p1"><span class="Apple-converted-space">      </span>errorDiv.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">      </span>processBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
